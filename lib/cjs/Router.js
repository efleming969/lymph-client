"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.match = function (pathname, routes) {
    let match;
    let index;
    const params = {};
    const routeKeys = Object.keys(routes);
    for (let i = 0; i < routeKeys.length && !match; i++) {
        const route = routeKeys[i];
        const keys = [];
        pathname.replace(RegExp(route === "*"
            ? ".*"
            : "^" +
                route.replace(/\//g, "\\/").replace(/:([\w]+)/g, function (_, key) {
                    keys.push(key);
                    return "([-\\.%\\w\\(\\)]+)";
                }) +
                "/?$", "g"), function () {
            for (let j = 1; j < arguments.length - 2;) {
                let value = arguments[j++];
                try {
                    value = decodeURI(value);
                }
                catch (_) {
                }
                params[keys.shift()] = value;
            }
            match = route;
            index = i;
        });
    }
    return routes[match](params);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUm91dGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL1JvdXRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFhLFFBQUEsS0FBSyxHQUFHLFVBQVcsUUFBUSxFQUFFLE1BQU07SUFDNUMsSUFBSSxLQUFLLENBQUE7SUFDVCxJQUFJLEtBQUssQ0FBQTtJQUNULE1BQU0sTUFBTSxHQUFHLEVBQUUsQ0FBQTtJQUNqQixNQUFNLFNBQVMsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFFLE1BQU0sQ0FBRSxDQUFBO0lBRXZDLEdBQUcsQ0FBQyxDQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDLE1BQU0sSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRyxDQUFDO1FBQ3BELE1BQU0sS0FBSyxHQUFHLFNBQVMsQ0FBRSxDQUFDLENBQUUsQ0FBQTtRQUM1QixNQUFNLElBQUksR0FBRyxFQUFFLENBQUE7UUFDZixRQUFRLENBQUMsT0FBTyxDQUNaLE1BQU0sQ0FDRixLQUFLLEtBQUssR0FBRztZQUNULENBQUMsQ0FBQyxJQUFJO1lBQ04sQ0FBQyxDQUFDLEdBQUc7Z0JBQ0wsS0FBSyxDQUFDLE9BQU8sQ0FBRSxLQUFLLEVBQUUsS0FBSyxDQUFFLENBQUMsT0FBTyxDQUFFLFdBQVcsRUFBRSxVQUFXLENBQUMsRUFBRSxHQUFHO29CQUNqRSxJQUFJLENBQUMsSUFBSSxDQUFFLEdBQUcsQ0FBRSxDQUFBO29CQUNoQixNQUFNLENBQUMscUJBQXFCLENBQUE7Z0JBQ2hDLENBQUMsQ0FBRTtnQkFDSCxLQUFLLEVBQ1QsR0FBRyxDQUNOLEVBQ0Q7WUFDSSxHQUFHLENBQUMsQ0FBRSxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxHQUFJLENBQUM7Z0JBQzFDLElBQUksS0FBSyxHQUFHLFNBQVMsQ0FBRSxDQUFDLEVBQUUsQ0FBRSxDQUFBO2dCQUM1QixJQUFJLENBQUM7b0JBQ0QsS0FBSyxHQUFHLFNBQVMsQ0FBRSxLQUFLLENBQUUsQ0FBQTtnQkFDOUIsQ0FBQztnQkFBQyxLQUFLLENBQUMsQ0FBRSxDQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUNmLENBQUM7Z0JBQ0QsTUFBTSxDQUFFLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBRSxHQUFHLEtBQUssQ0FBQTtZQUNsQyxDQUFDO1lBQ0QsS0FBSyxHQUFHLEtBQUssQ0FBQTtZQUNiLEtBQUssR0FBRyxDQUFDLENBQUE7UUFDYixDQUFDLENBQ0osQ0FBQTtJQUNMLENBQUM7SUFFRCxNQUFNLENBQUMsTUFBTSxDQUFFLEtBQUssQ0FBRSxDQUFFLE1BQU0sQ0FBRSxDQUFBO0FBQ3BDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBtYXRjaCA9IGZ1bmN0aW9uICggcGF0aG5hbWUsIHJvdXRlcyApIHtcbiAgICBsZXQgbWF0Y2hcbiAgICBsZXQgaW5kZXhcbiAgICBjb25zdCBwYXJhbXMgPSB7fVxuICAgIGNvbnN0IHJvdXRlS2V5cyA9IE9iamVjdC5rZXlzKCByb3V0ZXMgKVxuXG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgcm91dGVLZXlzLmxlbmd0aCAmJiAhbWF0Y2g7IGkrKyApIHtcbiAgICAgICAgY29uc3Qgcm91dGUgPSByb3V0ZUtleXNbIGkgXVxuICAgICAgICBjb25zdCBrZXlzID0gW11cbiAgICAgICAgcGF0aG5hbWUucmVwbGFjZShcbiAgICAgICAgICAgIFJlZ0V4cChcbiAgICAgICAgICAgICAgICByb3V0ZSA9PT0gXCIqXCJcbiAgICAgICAgICAgICAgICAgICAgPyBcIi4qXCJcbiAgICAgICAgICAgICAgICAgICAgOiBcIl5cIiArXG4gICAgICAgICAgICAgICAgICAgIHJvdXRlLnJlcGxhY2UoIC9cXC8vZywgXCJcXFxcL1wiICkucmVwbGFjZSggLzooW1xcd10rKS9nLCBmdW5jdGlvbiAoIF8sIGtleSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleXMucHVzaCgga2V5IClcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIihbLVxcXFwuJVxcXFx3XFxcXChcXFxcKV0rKVwiXG4gICAgICAgICAgICAgICAgICAgIH0gKSArXG4gICAgICAgICAgICAgICAgICAgIFwiLz8kXCIsXG4gICAgICAgICAgICAgICAgXCJnXCJcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZm9yICggbGV0IGogPSAxOyBqIDwgYXJndW1lbnRzLmxlbmd0aCAtIDI7ICkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBhcmd1bWVudHNbIGorKyBdXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlY29kZVVSSSggdmFsdWUgKVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICggXyApIHtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwYXJhbXNbIGtleXMuc2hpZnQoKSBdID0gdmFsdWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbWF0Y2ggPSByb3V0ZVxuICAgICAgICAgICAgICAgIGluZGV4ID0gaVxuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgfVxuXG4gICAgcmV0dXJuIHJvdXRlc1sgbWF0Y2ggXSggcGFyYW1zIClcbn1cblxuIl19