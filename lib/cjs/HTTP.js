"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Utils_1 = require("./Utils");
const fetchHeaders = {
    "Content-Type": "application/json",
    "Accept": "application/json"
};
exports.createFetchOptions = function (method, token, data) {
    const headers = Utils_1.merge(fetchHeaders, token ? { "Authorization": token } : {});
    const body = data ? JSON.stringify(data) : null;
    return { method, headers, body };
};
class default_1 {
    constructor(fetch) {
        this.fetch = fetch;
    }
    post(path, data, auth_token) {
        const options = exports.createFetchOptions("POST", auth_token, data);
        return this.fetch(path, options).then(function (response) {
            return response.json().then(function (data) {
                if (response.status === 400)
                    throw data;
                return data;
            });
        });
    }
    get(path, auth_token) {
        const options = exports.createFetchOptions("GET", auth_token, null);
        return this.fetch(path, options).then(function (response) {
            return response.json().then(function (data) {
                if (response.status === 400)
                    throw data;
                return data;
            });
        });
    }
}
exports.default = default_1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSFRUUC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9IVFRQLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsbUNBQStCO0FBRS9CLE1BQU0sWUFBWSxHQUFHO0lBQ2pCLGNBQWMsRUFBRSxrQkFBa0I7SUFDbEMsUUFBUSxFQUFFLGtCQUFrQjtDQUMvQixDQUFBO0FBRVksUUFBQSxrQkFBa0IsR0FBRyxVQUFXLE1BQWMsRUFBRSxLQUFhLEVBQUUsSUFBUztJQUNqRixNQUFNLE9BQU8sR0FBRyxhQUFLLENBQUUsWUFBWSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxlQUFlLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBRSxDQUFBO0lBQzlFLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBRSxJQUFJLENBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFBO0lBRWpELE1BQU0sQ0FBQyxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUE7QUFDcEMsQ0FBQyxDQUFBO0FBRUQ7SUFDSSxZQUFzQixLQUFLO1FBQUwsVUFBSyxHQUFMLEtBQUssQ0FBQTtJQUMzQixDQUFDO0lBRUQsSUFBSSxDQUFHLElBQVksRUFBRSxJQUFTLEVBQUUsVUFBbUI7UUFDL0MsTUFBTSxPQUFPLEdBQUcsMEJBQWtCLENBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxJQUFJLENBQUUsQ0FBQTtRQUU5RCxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBRSxJQUFJLEVBQUUsT0FBTyxDQUFFLENBQUMsSUFBSSxDQUFFLFVBQVcsUUFBUTtZQUN4RCxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBRSxVQUFXLElBQUk7Z0JBQ3hDLEVBQUUsQ0FBQyxDQUFFLFFBQVEsQ0FBQyxNQUFNLEtBQUssR0FBSSxDQUFDO29CQUFDLE1BQU0sSUFBSSxDQUFBO2dCQUN6QyxNQUFNLENBQUMsSUFBSSxDQUFBO1lBQ2YsQ0FBQyxDQUFFLENBQUE7UUFDUCxDQUFDLENBQUUsQ0FBQTtJQUNQLENBQUM7SUFFRCxHQUFHLENBQUcsSUFBWSxFQUFFLFVBQW1CO1FBQ25DLE1BQU0sT0FBTyxHQUFHLDBCQUFrQixDQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsSUFBSSxDQUFFLENBQUE7UUFFN0QsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUUsSUFBSSxFQUFFLE9BQU8sQ0FBRSxDQUFDLElBQUksQ0FBRSxVQUFXLFFBQVE7WUFDeEQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUUsVUFBVyxJQUFJO2dCQUN4QyxFQUFFLENBQUMsQ0FBRSxRQUFRLENBQUMsTUFBTSxLQUFLLEdBQUksQ0FBQztvQkFBQyxNQUFNLElBQUksQ0FBQTtnQkFDekMsTUFBTSxDQUFDLElBQUksQ0FBQTtZQUNmLENBQUMsQ0FBRSxDQUFBO1FBQ1AsQ0FBQyxDQUFFLENBQUE7SUFDUCxDQUFDO0NBQ0o7QUF6QkQsNEJBeUJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbWVyZ2UgfSBmcm9tIFwiLi9VdGlsc1wiXG5cbmNvbnN0IGZldGNoSGVhZGVycyA9IHtcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICBcIkFjY2VwdFwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxufVxuXG5leHBvcnQgY29uc3QgY3JlYXRlRmV0Y2hPcHRpb25zID0gZnVuY3Rpb24gKCBtZXRob2Q6IHN0cmluZywgdG9rZW46IHN0cmluZywgZGF0YTogYW55ICkge1xuICAgIGNvbnN0IGhlYWRlcnMgPSBtZXJnZSggZmV0Y2hIZWFkZXJzLCB0b2tlbiA/IHsgXCJBdXRob3JpemF0aW9uXCI6IHRva2VuIH0gOiB7fSApXG4gICAgY29uc3QgYm9keSA9IGRhdGEgPyBKU09OLnN0cmluZ2lmeSggZGF0YSApIDogbnVsbFxuXG4gICAgcmV0dXJuIHsgbWV0aG9kLCBoZWFkZXJzLCBib2R5IH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yICggcHJpdmF0ZSBmZXRjaCApIHtcbiAgICB9XG5cbiAgICBwb3N0ICggcGF0aDogc3RyaW5nLCBkYXRhOiBhbnksIGF1dGhfdG9rZW4/OiBzdHJpbmcgKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSBjcmVhdGVGZXRjaE9wdGlvbnMoIFwiUE9TVFwiLCBhdXRoX3Rva2VuLCBkYXRhIClcblxuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaCggcGF0aCwgb3B0aW9ucyApLnRoZW4oIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpLnRoZW4oIGZ1bmN0aW9uICggZGF0YSApIHtcbiAgICAgICAgICAgICAgICBpZiAoIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAwICkgdGhyb3cgZGF0YVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICB9IClcbiAgICAgICAgfSApXG4gICAgfVxuXG4gICAgZ2V0ICggcGF0aDogc3RyaW5nLCBhdXRoX3Rva2VuPzogc3RyaW5nICkge1xuICAgICAgICBjb25zdCBvcHRpb25zID0gY3JlYXRlRmV0Y2hPcHRpb25zKCBcIkdFVFwiLCBhdXRoX3Rva2VuLCBudWxsIClcblxuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaCggcGF0aCwgb3B0aW9ucyApLnRoZW4oIGZ1bmN0aW9uICggcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpLnRoZW4oIGZ1bmN0aW9uICggZGF0YSApIHtcbiAgICAgICAgICAgICAgICBpZiAoIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAwICkgdGhyb3cgZGF0YVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICB9IClcbiAgICAgICAgfSApXG4gICAgfVxufVxuIl19